# 🔄 راهنمای سیستم آپدیت ربات (فایل هاست)

## 📋 پیش‌نیازها

### 1. تنظیم فایل `version.json`
فایل `version.json` را با اطلاعات فایل آپدیت خود تنظیم کنید:

```json
{
    "version": "1.0.0",
    "release_date": "2024-01-01",
    "features": [
        "حذف خودکار پیام‌های قفل شده",
        "سیستم آپدیت خودکار",
        "بهبود عملکرد کلی",
        "قفل زبان فارسی",
        "حذف پیام‌های ویرایش شده"
    ],
    "update_file": "update.zip",
    "update_url": "https://your-domain.com/update.zip",
    "backup_enabled": true,
    "auto_backup": true
}
```

### 2. آماده‌سازی فایل آپدیت

#### الف) ایجاد فایل ZIP آپدیت
**روش 1: از طریق مرورگر**
```
https://your-domain.com/bot.php?action=create_update
```

**روش 2: از طریق خط فرمان**
```bash
php bot.php create_update
```

**روش 3: با نسخه مشخص**
```bash
php bot.php create_update 1.0.1
```

فایل‌های زیر به صورت خودکار در ZIP قرار می‌گیرند:
- `bot.php` (فایل اصلی ربات)
- `handler.php` (پردازش پیام‌ها)
- `config.php` (تنظیمات)
- `index.php` (فایل اصلی)
- `version.json` (به‌روزرسانی شده)

#### ب) آپلود فایل آپدیت
1. فایل ZIP را در هاست خود آپلود کنید
2. آدرس فایل را در `version.json` تنظیم کنید
3. مطمئن شوید که فایل قابل دانلود است

### 3. ساختار فایل آپدیت
```
update.zip
├── bot.php
├── handler.php
├── config.php
├── index.php
├── version.json (اختیاری)
└── فایل‌های جدید
```

## 🔧 نحوه استفاده

### 1. بررسی آپدیت
- از پنل مدیریت روی "🔄 آپدیت ربات" کلیک کنید
- ربات وجود فایل آپدیت را بررسی می‌کند
- اگر فایل موجود باشد، اطلاعات آن نمایش داده می‌شود

### 2. نصب آپدیت
- اگر آپدیت موجود باشد، روی "✅ بله، آپدیت کن" کلیک کنید
- ربات فایل را دانلود و استخراج می‌کند
- نسخه و تاریخ آپدیت به‌روزرسانی می‌شود

### 3. اطلاعات نمایش داده شده
- 📦 نسخه فعلی
- 📁 نام فایل آپدیت
- 📏 حجم فایل
- 📅 تاریخ فایل
- 💾 پشتیبان (در صورت فعال بودن)

## ⚠️ نکات مهم

### 1. امنیت
- فقط فایل‌های معتبر آپلود کنید
- قبل از آپدیت از کد فعلی backup بگیرید
- تست آپدیت در محیط آزمایشی

### 2. سازگاری
- آپدیت‌ها باید با نسخه فعلی سازگار باشند
- فایل‌های پیکربندی را حفظ کنید
- پوشه `data/` را در آپدیت قرار ندهید

### 3. پشتیبانی
- در صورت مشکل، از backup استفاده کنید
- لاگ‌های آپدیت را بررسی کنید
- با پشتیبانی تماس بگیرید

## 🚀 قابلیت‌های جدید

### ✅ سیستم آپدیت محلی
- آپدیت از فایل ZIP در هاست
- پشتیبان‌گیری خودکار
- بررسی وجود فایل آپدیت
- نمایش اطلاعات فایل

### ✅ قفل زبان فارسی
- کاربران فقط می‌توانند پیام‌های فارسی بفرستند
- دستور `/start` به انگلیسی مجاز است
- پیام‌های غیرفارسی فوراً حذف می‌شوند

### ✅ حذف پیام‌های ویرایش شده
- پیام‌های ویرایش شده فوراً حذف می‌شوند
- از تغییر محتوای پیام‌ها جلوگیری می‌کند
- امنیت بیشتری فراهم می‌کند

## 📁 ساختار پوشه‌ها

```
/
├── bot.php
├── handler.php
├── config.php
├── index.php
├── version.json
├── data/
│   └── data.json
├── backups/
│   └── backup_2024-01-01_12-00-00.zip
└── update.zip (فایل آپدیت)
```

## 🔄 مراحل آپدیت

### 1. آماده‌سازی
- فایل آپدیت را ایجاد کنید: `php bot.php create_update`
- فایل ZIP ایجاد شده را در هاست آپلود کنید
- آدرس فایل را در `version.json` تنظیم کنید

### 2. بررسی
- ربات وجود فایل را بررسی می‌کند
- اطلاعات فایل نمایش داده می‌شود
- کاربر تصمیم می‌گیرد آپدیت کند یا نه

### 3. نصب
- پشتیبان از فایل‌های فعلی گرفته می‌شود
- فایل آپدیت دانلود و استخراج می‌شود
- نسخه به‌روزرسانی می‌شود

## 📞 پشتیبانی
برای سوالات و مشکلات با توسعه‌دهنده تماس بگیرید.