## ุฑุจุงุช ุชูฺฏุฑุงู: ุฑูุฑุงู + ุงูุชุงุฒ + ูุฑูุดฺฏุงู ุขุชู (PHP + MySQL)

ุงู ูพุฑูฺู ฺฉ ุฑุจุงุช ุชฺฉโูุงู PHP ุงุณุช ฺฉู ุดุงูู ุณุณุชู ุฑูุฑุงูุ ุงูุชุงุฒุ ูุฑูุดฺฏุงู ุขุชูุ ูุฏุฑุช ฺฉุงูุงูโูุง ุงุฌุจุงุฑุ ุจู/ุขูุจูุ ุฌุงุฒู ุฑูุฒุงููุ ููููฺฏุ ูุณุงุจูู ููุชฺฏ ู ูุฑุนูโฺฉุด ููุชฺฏ ุงุณุช.

### ูพุดโูุงุฒูุง
- PHP 7.4+ (ูุนุงู ุจูุฏู ุงูุฒูููโูุง curl ู pdo_mysql)
- MySQL 5.7+/8+
- ฺฉ ุฏุงููู HTTPS ุจุฑุง ูุจููฺฉ ุชูฺฏุฑุงู

### ุฑุงูโุงูุฏุงุฒ ุฏุชุงุจุณ
- ุงุฌุงุฏ ุฏุชุงุจุณ (ูุงู ูพุดโูุฑุถ: `telegram_referral_bot`):
```bash
mysql -u root -p -e "CREATE DATABASE telegram_referral_bot CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"
```
- ุฌุฏุงูู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุจุง ุงููู ุฏุฑุฎูุงุณุช ุณุงุฎุชู ูโุดููุฏ.

### ูุชุบุฑูุง ูุญุท
- `BOT_TOKEN` ุชูฺฉู ุฑุจุงุช ุงุฒ `@BotFather`
- `BOT_USERNAME` ูุงู ฺฉุงุฑุจุฑ ุฑุจุงุช ุจุฏูู @ (ุจุฑุง ุณุงุฎุช ููฺฉ ุฏุนูุช)
- `DB_HOST` ูพุดโูุฑุถ `127.0.0.1`
- `DB_PORT` ูพุดโูุฑุถ `3306`
- `DB_NAME` ูพุดโูุฑุถ `telegram_referral_bot`
- `DB_USER` ูพุดโูุฑุถ `root`
- `DB_PASS` ูพุดโูุฑุถ ุฎุงู
- `ADMIN_IDS` ุดูุงุณูโูุง ุนุฏุฏ ุงุฏููโูุงุ ุฌุฏุง ุจุง ูุฑฺฏูู: ูุซูุง `123,456`
- `ADMIN_GROUP_ID` ุดูุงุณู ฺฏุฑูู ุงุฏูู ุจุฑุง ุฏุฑุงูุช ุฏุฑุฎูุงุณุชโูุง (ุงุฎุชุงุฑ)
- `PUBLIC_ANNOUNCE_CHANNEL_ID` ฺฉุงูุงู ุนููู ุจุฑุง ุงุนูุงูโูุง (ุงุฎุชุงุฑ)
- `REFERRAL_REWARD_POINTS` ุงูุชุงุฒ ูพุงุฏุงุด ูุฑ ุฏุนูุช (ูพุดโูุฑุถ 10)
- `DAILY_BONUS_POINTS` ุงูุชุงุฒ ุฌุงุฒู ุฑูุฒุงูู (ูพุดโูุฑุถ 5)
- `LOTTERY_TICKET_COST` ูุฒูู ุจูุช ูุฑุนูโฺฉุด (ูพุดโูุฑุถ 10)
- `LOTTERY_PRIZE_POINTS` ุฌุงุฒู ูุฑุนูโฺฉุด (ูพุดโูุฑุถ 200)
- `ANTI_SPAM_MIN_INTERVAL_MS` ุญุฏุงูู ูุงุตูู ุจู ุฏุฑุฎูุงุณุชโูุง ฺฉุงุฑุจุฑ ุจู ููโุซุงูู (ูพุดโูุฑุถ 700)
- `WEEKLY_TOP_REWARDS` ูุงูุจ `ุฑุชุจู:ุงูุชุงุฒ` ูุซู `1:300,2:200,3:100`
- `CRON_SECRET` ุฑุดุชู ุงููุช ุจุฑุง ุงุฌุฑุง ฺฉุฑุงูโูุง ุงุฒ ุทุฑู GET (ุชูุตู ูโุดูุฏ ุชูุธู ุดูุฏ)

ูุญูู ุณุช ฺฉุฑุฏู ูุชุบุฑูุง ุจุณุชู ุจู ูุจโุณุฑูุฑ ูุชูุงูุชู (nginx: fastcgi_paramุ apache: SetEnvุ ุง ูุงู ุณุฑูุณ systemd).

### ุงุณุชูุฑุงุฑ
- ูุงู `bot.php` ุฑุง ุฑู ูุงุณุช ุฎูุฏ (ูุณุฑ ุนููู) ูุฑุงุฑ ุฏูุฏ.
- ุฑุจุงุช ุฑุง ุฏุฑ ฺฉุงูุงูโูุง ฺฉู ุจุงุฏ ุนุถูุช ุงุฌุจุงุฑ ฺฺฉ ุดูุฏุ ุงุฏูู ฺฉูุฏ.
- ูุจููฺฉ ุฑุง ุชูุธู ฺฉูุฏ:
```bash
curl -X POST "https://api.telegram.org/bot$BOT_TOKEN/setWebhook" \
  -d "url=https://YOUR-DOMAIN.TLD/bot.php" \
  -d "allowed_updates=[\"message\",\"callback_query\"]"
```
- ุฌูุช ุจุฑุฑุณ ูุถุนุช:
```bash
curl -s "https://api.telegram.org/bot$BOT_TOKEN/getWebhookInfo" | jq .
```

### ุงุณุชูุงุฏู ฺฉุงุฑุจุฑ
- ุงุณุชุงุฑุช: ฺฉุงุฑุจุฑ ุงฺฏุฑ ุจุง ููฺฉ `https://t.me/BOT_USERNAME?start=USERID` ูุงุฑุฏ ุดูุฏุ ูพุณ ุงุฒ ุชุงุฏ ุนุถูุช ุฏุฑ ฺฉุงูุงูโูุง ุงุฌุจุงุฑุ ุงูุชุงุฒ ุจู ุฏุนูุชโฺฉููุฏู ุฏุงุฏู ูโุดูุฏ (ุถุฏ ุชููุจ).
- ููู ฺฉุงุฑุจุฑ: ยซุงูุชุงุฒ ููยปุ ยซููฺฉ ุฏุนูุช ููยปุ ยซูุฑูุดฺฏุงู ุขุชูโูุงยปุ ยซุฏุฑุฎูุงุณุชโูุง ููยปุ ยซุนุถูุช ุฏุฑ ฺฉุงูุงูโูุงยปุ ยซุฌุงุฒู ุฑูุฒุงููยปุ ยซูพุฑููุงูยปุ ยซุจุฑุชุฑูโูุง ููุชูยปุ ยซุฎุฑุฏ ุจูุช ูุฑุนูโฺฉุดยปุ ยซูุฑุนูโฺฉุดยป.

### ูพูู ุงุฏูู (ุฏุฑ ฺุช ุฎุตูุต ุจุง ุฑุจุงุช)
- ุฏฺฉูู: ยซ๐ ูพูู ุงุฏููยป ุณูพุณ ุฏุณุชูุฑุงุช:
```
/add_item ูุงู | ูุฒูู
/del_item ID
/items_list
/channels_add @username ุง -100...
/channels_list
/channels_del chat_id
/users_list [page]
/set_points user_id amount
/add_points user_id amount
/sub_points user_id amount
/ban user_id
/unban user_id
/cron_weekly      # ูพุฑุฏุงุฎุช ูพุงุฏุงุด ููุชู ูุจู ุฏุณุช
/cron_lottery     # ูุฑุนูโฺฉุด ููุชู ูุจู ุฏุณุช
```
ูฺฉุงุช:
- ุจุฑุง ฺฺฉ ุนุถูุช ฺฉุงูุงูโูุงุ ุฑุจุงุช ุจุงุฏ ุงุฏูู ฺฉุงูุงู ุจุงุดุฏ.
- ุจุฑุง ุฏุฑุงูุช ุฏุฑุฎูุงุณุช ุขุชูโูุงุ ููุฏุงุฑ `ADMIN_GROUP_ID` ุฑุง ุชูุธู ฺฉูุฏ.

### ฺฉุฑุงูโูุง ููุชฺฏ (ุงุชููุงุชฺฉ)
ุจุฑุง ุงุฌุฑุง ุฎูุฏฺฉุงุฑ ูุณุงุจูู ุจุฑุชุฑู ุฏุนูุชโูุง ู ูุฑุนูโฺฉุด ููุชู ูุจูุ ฺฉุฑุงูโุฌุงุจ ุฑู ุณุฑูุฑ ุงุถุงูู ฺฉูุฏ. ุญุชูุง `CRON_SECRET` ุฑุง ุชูุธู ฺฉูุฏ.

- ูุณุงุจูู ููุชฺฏ (ุฏูุดูุจู 00:01 UTC ุง ูุทุงุจู ููุทูู ุฒูุงู ุณุฑูุฑ):
```bash
curl -fsS "https://YOUR-DOMAIN.TLD/bot.php?cron=weekly_referrals&secret=YOUR_SECRET" | logger -t bot-cron
```
- ูุฑุนูโฺฉุด ููุชฺฏ (ุฏูุดูุจู 00:05 UTC):
```bash
curl -fsS "https://YOUR-DOMAIN.TLD/bot.php?cron=weekly_lottery&secret=YOUR_SECRET" | logger -t bot-cron
```

ุฏุฑ ุตูุฑุช ุชูุธู `PUBLIC_ANNOUNCE_CHANNEL_ID`ุ ูุชุงุฌ ุฏุฑ ฺฉุงูุงู ุนููู ูู ุงุนูุงู ูโุดูุฏ.

### ูฺฉุงุช ุงููุช
- `CRON_SECRET` ุฑุง ููุฏุงุฑุฏู ฺฉูุฏ ู ููุท ุงุฒ ุทุฑู HTTPS ูุฑุงุฎูุงู ฺฉูุฏ.
- `ADMIN_IDS` ุฑุง ุฏูู ุชูุธู ฺฉูุฏ.
- ุฑุจุงุช ุฑุง ููุท ุฏุฑ ฺฉุงูุงูโูุง ููุฑุฏ ูุงุฒ ุงุฏูู ฺฉูุฏ.

### ุชูุณุนู ู ุฏุจุงฺฏ
- ุจุฑุฑุณ ุณูุชฺฉุณ:
```bash
php -l /path/to/bot.php
```
- ุจุฑุง ุชุบุฑ ุงูุชุงุฒ ุฏุนูุช ุง ุณุทุญโุจูุฏุ ูุชุบุฑูุง ู ุชูุงุจุน ุฏุฑ `bot.php` ูุงุจู ูุฑุงุด ูุณุชูุฏ.

### ูุงุณูุณ
ุงู ูพุฑูฺู ุจุฏูู ูุงุณูุณ ุฑุณู ุงุฑุงุฆู ุดุฏู ู ุงุณุชูุงุฏู ุงุฒ ุขู ุขุฒุงุฏ ุงุณุช. ูุณุฆููุช ุฑุนุงุช ููุงูู ุชูฺฏุฑุงู ู ููุงูู ูุญู ุจุง ุดูุงุณุช.